# Web

- [POST, GET방식의 차이](#POST,-GET방식의-차이점)
- [CORS](#CORS)

## POST, GET방식의 차이점

Get, Post 방식은 HTTP 프로토콜을 이용해서 서버에 무언가를 요청할 때 사용하는 방식입니다.

Get : URL(주소창)을 통해서 모든파라미터를 전달함, 주소창에 전달되는 값이 노출이 되기에 ID/PW 등의 정보를 Get방식으로 전달하면 문제가 발생 할 가능성이 있음, URL길이가 제한이 있기에 많은양 전달 불가, URL형식에 맞지않는 파라미터 이름과 값은 인코딩 해서 전달해야함
http://url/bbslist.html?id=5&pagenum=2 같이 하는 것 -> 주소줄 뒤에 ?이걸로 시작.

Post : 전달하고자 하는 정보가 HTTP Body에 포함되어 전달됨, 웹브라우저 사용자의 눈에 직접적으로 파라미터가 노출이 안됨, 길이에 제한이 없음.

추가 : 언제 GET을 쓰고, 언제 POST를 써야함?

GET은 가져오는 것, POST는 수행하는 것. (이게 중요!)

GET은 select 적인 성향이 있음. 서버에서 어떤 데이터를 가져와서 보여준다거나 하는 용도

POST는 서버의 값이나 상태를 바꾸기 위해서 사용.

## CORS

CORS는 다른 도메인 간에 자원을 공유할 수 있도록 외부 도메인 서버와 통신하기 위한 방식을 표준화한 스펙이다. 서버와 클라이언트가 정해진 헤더를 통해 서로 요청이나 응답에 반응할지 결정하는 방식이다.

> 그렇다면 왜 다른 도메인간에 통신이 불가능한가?

### 동일 출처 정책(Same-origin Policy)

웹페이지에서 리소스를 불러올 때 리소스의 출처가 웹페이지의 출처와 같으면 안전하다고 보고(`same-origin`), 출처가 다르면(`cross-origin`) 해당 리소스는 안전하지 않다고 보는 원칙이다.

`출처 = 프로토콜 + 도메인 + 포트번호`

![](https://user-content.gitlab-static.net/d550a2ffbfabf1073939172982c905a3d20d8c52/68747470733a2f2f6769746875622e636f6d2f6b696d7365756c62692f54494c2f7261772f6d61737465722f4a6176615363726970742f61737365742f2545422538462539392545432539442542432545432542362539432545432542322539382545432541302539352545432542312538352e706e67)

요즘 여러 도메인에 걸쳐서 구성되는 대규모 웹 프로젝트가 늘어나고, REST API 등을 이용한 외부 호출이 많아지는 상황에서는 거추장스러운 기술이 되기도하고 있다. 그래서 만들어진 추가 정책이 CORS이다.

### Preflight Request

요청하려는 url이 다른 도메인일 경우 웹브라우저는 preflight요청을 먼저 날린다.
preflight 요청은 실제 요청존애 인증 헤더를 미리 전송해 해당 서버에 요청 권한이 있는지 확인한다. 서버측에서는 preflight 요청에 대한 처리가 필요하다.

preflight 요청은 HTTP 의 `OPTIONS` 메서드를 사용하며 `Access-Control-Request-*` 형태의 헤더로 전송한다.

![](https://user-content.gitlab-static.net/b08e6a235bfe1a6e36c2e0373abf502cdc70b153/68747470733a2f2f6769746875622e636f6d2f6b696d7365756c62692f54494c2f7261772f6d61737465722f4a6176615363726970742f61737365742f636f72732e706e67)

### Request headers(클라이언트의 요청 해더)

| header                         | description                         |
| ------------------------------ | ----------------------------------- |
| Origin                         | 요청을 보내는 페이지의 출처(도메인) |
| Access-Control-Request-Method  | 실제 요청하려는 메서드              |
| Access-Control-Request-Headers | 실제 요청에 포함되어 해더 이름      |

### Response headers(서버에서의 응답 해더)

| header                           | description                                                                                                                                                                                                               |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Access-Control-Allow-Origin      | 요청을 허용하는 출처 \*이면 모든 곳에 공개되어 있음을 의미                                                                                                                                                                |
| Access-Control-Allow-Credentials | 클라이언트 요청이 쿠키를 통해서 자격 증명을 해야 하는 경우에 true. true를 응답받은 클라이언트는 실제 요청 시 서버에서 정의된 규격의 인증값이 담긴 쿠키를 같이 보내야 한다.                                                |
| Access-Control-Expose-Headers    | 클라이언트 요청에 포함되어도 되는 사용자 정의 해더                                                                                                                                                                        |
| Access-Control-Max-Age           | 클라이언트에서 preflight의 요청 결과를 저장할 기간을 지정. 클라이언트에서 preflight 요청의 결과를 저장하고 있을 시간이다. 해당 시간 동안은 preflight요청을 다시 하지 않게 된다.                                           |
| Access-Control-Allow-Methods     | 요청을 허용하는 매서드. 기본값은 GET, POST라고 보면 된다. 이 해더가 없으면 GET과 POST 요청만 가능하다. 만약 이 해더가 지정이 되어 있으면, 클라이언트에서는 해더값에 해당하는 메서드일 경우에만 실제 요청을 시도하게 된다. |
| Access-Control-Allow-Headers     | 요청을 허용하는 매서드.                                                                                                                                                                                                   |

### 결론적으로

**서버**

- 서버가 이 스펙을 지원한다고 해서 다른 보안정책을 마련하지 않으면 안된다.
- 일반적인 웹 브라우저에서 스크립트에 의한 Ajax 요청만 적용을 받을 수있다고 생각해야된다.
- open API 같은 것을 개발중이라면 클라이언트가 각종 편법들을 동원해서 서버에 접근하지 않아도 되도록 CORS요청을 핸들링 해줘야한다.

**클라이언트**

- 개발자가 데스트 혹은 개발단계에서 쉽게 요청하기: 웹 브라우저 실행 옵션이나 플로그인을 통한 CORS 회피
- CORS구현이 안되어 있는 서버로 ajax요청을 해야 하지만 서버 쪽 컨트롤이 불가능할 경우: jsonp방식으로 요청
- Ajax요청을 해야 하는 다른 도메인의 서버를 클라이언트와 같이 개발하거나 서버 개발 쪽 수정 요청이 가능한 경우:
  - 서버에서 CORS 요청이 허용되도록 구현,
  - cors 미들웨어를 사용
- 프론트엔드와 API서버를 같은 도메인으로 제공한다.: CORS적용 안하면 됨
